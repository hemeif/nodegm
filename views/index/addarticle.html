<% include header.html %>
<link rel="stylesheet" type="text/css" href="index/css/wangEditor.min.css">
<div class="container">
    <div class="row">
        <form class="form-horizontal" method="post"  action="/addarticle">
            <div class="form-group">
                <label  class="col-sm-2 control-label">标题</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control"  placeholder="请输入标题" name="title">
                </div>
            </div>
            <div class="form-group">
                <label for="inputPassword3" class="col-sm-2 control-label">分类</label>
                <div class="col-sm-10">
                    <select name="cid" class="form-control">
                        <option value="1" selected>心情</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <div id="content"  style="height:400px;max-height:500px;"></div>
                    <textarea name="content" hidden id="contents" cols="0" rows="0"></textarea>
                </div>
            </div>
            <div class="form-group">
                <input type="hidden" name="uid" value="<%= uid %>">
                <input type="hidden" name="thumb" id="thumb">
                <div class="col-sm-offset-2 col-sm-10">
                    <button type="submit" class="btn btn-default">添加文章</button>
                </div>
            </div>
        </form>
    </div>
</div>

<script type="text/javascript" src="index/js/wangEditor.min.js"></script>
<script type="text/javascript">
    var editor = new wangEditor("content");
    editor.config.uploadImgUrl = 'index/upload';
    editor.config.uploadImgFileName = 'thumb';
    // 自定义load事件
    editor.config.uploadImgFns.onload = function (resultText, xhr) {
        console.log(resultText);
        // resultText 服务器端返回的text
        // xhr 是 xmlHttpRequest 对象，IE8、9中不支持

        // 上传图片时，已经将图片的名字存在 editor.uploadImgOriginalName
        var originalName = editor.uploadImgOriginalName || '';

        editor.command(null, 'insertHtml', '<img src="' + resultText + '" alt="' + originalName + '" style="max-width:100%;"/>');
        $("#thumb").val(resultText);

    };
    $('.btn').click(function () {
        $("#contents").val(editor.$txt.html());
    })
    editor.create();

</script>
<% include footer.html %>